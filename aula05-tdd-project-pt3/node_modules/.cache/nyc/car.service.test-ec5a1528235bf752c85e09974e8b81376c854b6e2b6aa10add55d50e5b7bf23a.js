function cov_zzyufbn4y(){var path="/Users/gustavo.farias/projects/jsexpert/aula05-tdd-project-pt3/test/unit/car.service.test.js";var hash="2dbc93b027dcae01f1fbf985b880f0f33a3c3afd";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/gustavo.farias/projects/jsexpert/aula05-tdd-project-pt3/test/unit/car.service.test.js",statementMap:{"0":{start:{line:1,column:56},end:{line:1,column:72}},"1":{start:{line:2,column:19},end:{line:2,column:59}},"2":{start:{line:3,column:20},end:{line:3,column:68}},"3":{start:{line:5,column:17},end:{line:5,column:32}},"4":{start:{line:6,column:19},end:{line:6,column:34}},"5":{start:{line:7,column:14},end:{line:7,column:30}},"6":{start:{line:9,column:21},end:{line:9,column:69}},"7":{start:{line:11,column:14},end:{line:15,column:1}},"8":{start:{line:17,column:0},end:{line:123,column:3}},"9":{start:{line:18,column:21},end:{line:18,column:23}},"10":{start:{line:19,column:18},end:{line:19,column:20}},"11":{start:{line:21,column:4},end:{line:23,column:7}},"12":{start:{line:22,column:8},end:{line:22,column:60}},"13":{start:{line:25,column:4},end:{line:27,column:7}},"14":{start:{line:26,column:8},end:{line:26,column:40}},"15":{start:{line:29,column:4},end:{line:31,column:7}},"16":{start:{line:30,column:8},end:{line:30,column:26}},"17":{start:{line:33,column:4},end:{line:55,column:7}},"18":{start:{line:34,column:20},end:{line:34,column:34}},"19":{start:{line:35,column:28},end:{line:35,column:65}},"20":{start:{line:37,column:8},end:{line:37,column:38}},"21":{start:{line:39,column:8},end:{line:42,column:34}},"22":{start:{line:44,column:8},end:{line:47,column:10}},"23":{start:{line:49,column:23},end:{line:49,column:68}},"24":{start:{line:50,column:25},end:{line:50,column:28}},"25":{start:{line:52,column:8},end:{line:52,column:63}},"26":{start:{line:53,column:8},end:{line:53,column:81}},"27":{start:{line:54,column:8},end:{line:54,column:50}},"28":{start:{line:57,column:4},end:{line:62,column:7}},"29":{start:{line:58,column:24},end:{line:58,column:35}},"30":{start:{line:59,column:23},end:{line:59,column:69}},"31":{start:{line:61,column:8},end:{line:61,column:63}},"32":{start:{line:64,column:4},end:{line:75,column:7}},"33":{start:{line:65,column:28},end:{line:65,column:50}},"34":{start:{line:67,column:8},end:{line:67,column:74}},"35":{start:{line:69,column:23},end:{line:69,column:62}},"36":{start:{line:71,column:25},end:{line:71,column:46}},"37":{start:{line:73,column:8},end:{line:73,column:74}},"38":{start:{line:74,column:8},end:{line:74,column:45}},"39":{start:{line:77,column:4},end:{line:95,column:7}},"40":{start:{line:78,column:25},end:{line:78,column:59}},"41":{start:{line:79,column:8},end:{line:79,column:26}},"42":{start:{line:81,column:28},end:{line:81,column:65}},"43":{start:{line:82,column:8},end:{line:82,column:33}},"44":{start:{line:84,column:29},end:{line:84,column:30}},"45":{start:{line:86,column:8},end:{line:89,column:54}},"46":{start:{line:89,column:20},end:{line:89,column:52}},"47":{start:{line:91,column:25},end:{line:91,column:65}},"48":{start:{line:92,column:23},end:{line:92,column:90}},"49":{start:{line:94,column:8},end:{line:94,column:50}},"50":{start:{line:97,column:4},end:{line:122,column:7}},"51":{start:{line:98,column:20},end:{line:98,column:49}},"52":{start:{line:99,column:28},end:{line:103,column:9}},"53":{start:{line:105,column:25},end:{line:105,column:59}},"54":{start:{line:106,column:8},end:{line:106,column:26}},"55":{start:{line:108,column:29},end:{line:108,column:30}},"56":{start:{line:109,column:24},end:{line:109,column:48}},"57":{start:{line:111,column:20},end:{line:111,column:41}},"58":{start:{line:113,column:8},end:{line:113,column:45}},"59":{start:{line:114,column:8},end:{line:114,column:66}},"60":{start:{line:116,column:31},end:{line:116,column:71}},"61":{start:{line:117,column:23},end:{line:117,column:81}},"62":{start:{line:119,column:25},end:{line:119,column:92}},"63":{start:{line:121,column:8},end:{line:121,column:50}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:17,column:35},end:{line:17,column:36}},loc:{start:{line:17,column:41},end:{line:123,column:1}},line:17},"1":{name:"(anonymous_1)",decl:{start:{line:21,column:11},end:{line:21,column:12}},loc:{start:{line:21,column:17},end:{line:23,column:5}},line:21},"2":{name:"(anonymous_2)",decl:{start:{line:25,column:15},end:{line:25,column:16}},loc:{start:{line:25,column:21},end:{line:27,column:5}},line:25},"3":{name:"(anonymous_3)",decl:{start:{line:29,column:14},end:{line:29,column:15}},loc:{start:{line:29,column:20},end:{line:31,column:5}},line:29},"4":{name:"(anonymous_4)",decl:{start:{line:33,column:60},end:{line:33,column:61}},loc:{start:{line:33,column:72},end:{line:55,column:5}},line:33},"5":{name:"(anonymous_5)",decl:{start:{line:57,column:57},end:{line:57,column:58}},loc:{start:{line:57,column:63},end:{line:62,column:5}},line:57},"6":{name:"(anonymous_6)",decl:{start:{line:64,column:65},end:{line:64,column:66}},loc:{start:{line:64,column:71},end:{line:75,column:5}},line:64},"7":{name:"(anonymous_7)",decl:{start:{line:77,column:104},end:{line:77,column:105}},loc:{start:{line:77,column:110},end:{line:95,column:5}},line:77},"8":{name:"(anonymous_8)",decl:{start:{line:89,column:14},end:{line:89,column:15}},loc:{start:{line:89,column:20},end:{line:89,column:52}},line:89},"9":{name:"(anonymous_9)",decl:{start:{line:97,column:92},end:{line:97,column:93}},loc:{start:{line:97,column:104},end:{line:122,column:5}},line:97}},branchMap:{},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0},b:{},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"2dbc93b027dcae01f1fbf985b880f0f33a3c3afd"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_zzyufbn4y=function(){return actualCoverage;};}return actualCoverage;}cov_zzyufbn4y();const{describe,it,before,beforeEach,afterEach}=(cov_zzyufbn4y().s[0]++,require('mocha'));const CarService=(cov_zzyufbn4y().s[1]++,require('../../src/service/car.service'));const Transaction=(cov_zzyufbn4y().s[2]++,require('../../src/entities/transaction.entity'));const{join}=(cov_zzyufbn4y().s[3]++,require('path'));const{expect}=(cov_zzyufbn4y().s[4]++,require('chai'));const sinon=(cov_zzyufbn4y().s[5]++,require('sinon'));const carsDatabase=(cov_zzyufbn4y().s[6]++,join(__dirname,'./../../database','cars.json'));const mocks=(cov_zzyufbn4y().s[7]++,{validCar:require('../mocks/valid-car.json'),validCarCategory:require('../mocks/valid-car-category.json'),validCustomer:require('../mocks/valid-customer.json')});cov_zzyufbn4y().s[8]++;describe('CarService Suite Tests',()=>{cov_zzyufbn4y().f[0]++;let carService=(cov_zzyufbn4y().s[9]++,{});let sandbox=(cov_zzyufbn4y().s[10]++,{});cov_zzyufbn4y().s[11]++;before(()=>{cov_zzyufbn4y().f[1]++;cov_zzyufbn4y().s[12]++;carService=new CarService({cars:carsDatabase});});cov_zzyufbn4y().s[13]++;beforeEach(()=>{cov_zzyufbn4y().f[2]++;cov_zzyufbn4y().s[14]++;sandbox=sinon.createSandbox();});cov_zzyufbn4y().s[15]++;afterEach(()=>{cov_zzyufbn4y().f[3]++;cov_zzyufbn4y().s[16]++;sandbox.restore();});cov_zzyufbn4y().s[17]++;it('given a category it should return a available car',async()=>{cov_zzyufbn4y().f[4]++;const car=(cov_zzyufbn4y().s[18]++,mocks.validCar);const carCategory=(cov_zzyufbn4y().s[19]++,Object.create(mocks.validCarCategory));cov_zzyufbn4y().s[20]++;carCategory.carIds=[car.id];cov_zzyufbn4y().s[21]++;sandbox.stub(carService.carRepository,'find').returns(mocks.validCar);cov_zzyufbn4y().s[22]++;sandbox.spy(carService,'chooseRandomCar');const result=(cov_zzyufbn4y().s[23]++,await carService.getAvailableCar(carCategory));const expected=(cov_zzyufbn4y().s[24]++,car);cov_zzyufbn4y().s[25]++;expect(carService.chooseRandomCar.calledOnce).to.be.ok;cov_zzyufbn4y().s[26]++;expect(carService.carRepository.find.calledWithExactly(car.id)).to.be.ok;cov_zzyufbn4y().s[27]++;expect(result).to.be.deep.equal(expected);});cov_zzyufbn4y().s[28]++;it('should retrive a random position from an array',()=>{cov_zzyufbn4y().f[5]++;const indexes=(cov_zzyufbn4y().s[29]++,[0,1,2,3,4]);const result=(cov_zzyufbn4y().s[30]++,carService.getRandomPositionFromArray(indexes));cov_zzyufbn4y().s[31]++;expect(result).to.be.lte(indexes.length).and.be.gte(0);});cov_zzyufbn4y().s[32]++;it('should choose the first ID from carsIds in carCategory',()=>{cov_zzyufbn4y().f[6]++;const carCategory=(cov_zzyufbn4y().s[33]++,mocks.validCarCategory);cov_zzyufbn4y().s[34]++;sandbox.stub(carService,'getRandomPositionFromArray').returns(0);const result=(cov_zzyufbn4y().s[35]++,carService.chooseRandomCar(carCategory));const expected=(cov_zzyufbn4y().s[36]++,carCategory.carIds[0]);cov_zzyufbn4y().s[37]++;expect(carService.getRandomPositionFromArray.calledOnce).to.be.ok;cov_zzyufbn4y().s[38]++;expect(result).to.be.equal(expected);});cov_zzyufbn4y().s[39]++;it('should calculate final amount in real when a carCategory, customer and numberOfDay were given',()=>{cov_zzyufbn4y().f[7]++;const customer=(cov_zzyufbn4y().s[40]++,Object.create(mocks.validCustomer));cov_zzyufbn4y().s[41]++;customer.age=50;const carCategory=(cov_zzyufbn4y().s[42]++,Object.create(mocks.validCarCategory));cov_zzyufbn4y().s[43]++;carCategory.price=37.6;const numberOfDays=(cov_zzyufbn4y().s[44]++,5);cov_zzyufbn4y().s[45]++;sandbox.stub(carService,'taxBasedOnAge').get(()=>{cov_zzyufbn4y().f[8]++;cov_zzyufbn4y().s[46]++;return[{from:40,to:50,tax:1.3}];});const expected=(cov_zzyufbn4y().s[47]++,carService.currencyFormat.format(244.40));const result=(cov_zzyufbn4y().s[48]++,carService.calculateFinalPrice(customer,carCategory,numberOfDays));cov_zzyufbn4y().s[49]++;expect(result).to.be.deep.equal(expected);});cov_zzyufbn4y().s[50]++;it('should return a transaction receipt when a customer and a car category were given',async()=>{cov_zzyufbn4y().f[9]++;const car=(cov_zzyufbn4y().s[51]++,Object.create(mocks.validCar));const carCategory=(cov_zzyufbn4y().s[52]++,{...mocks.validCarCategory,price:37.6,carIds:[car.id]});const customer=(cov_zzyufbn4y().s[53]++,Object.create(mocks.validCustomer));cov_zzyufbn4y().s[54]++;customer.age=20;const numberOfDays=(cov_zzyufbn4y().s[55]++,5);const dueDate=(cov_zzyufbn4y().s[56]++,'10 de novembro de 2020');const now=(cov_zzyufbn4y().s[57]++,new Date(2020,10,5));cov_zzyufbn4y().s[58]++;sandbox.useFakeTimers(now.getTime());cov_zzyufbn4y().s[59]++;sandbox.stub(carService,'getAvailableCar').resolves(car);const expectedAmount=(cov_zzyufbn4y().s[60]++,carService.currencyFormat.format(206.80));const result=(cov_zzyufbn4y().s[61]++,await carService.rent(customer,carCategory,numberOfDays));const expected=(cov_zzyufbn4y().s[62]++,new Transaction({customer,car,amount:expectedAmount,dueDate}));cov_zzyufbn4y().s[63]++;expect(result).to.be.deep.equal(expected);});});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJkZXNjcmliZSIsIml0IiwiYmVmb3JlIiwiYmVmb3JlRWFjaCIsImFmdGVyRWFjaCIsInJlcXVpcmUiLCJDYXJTZXJ2aWNlIiwiVHJhbnNhY3Rpb24iLCJqb2luIiwiZXhwZWN0Iiwic2lub24iLCJjYXJzRGF0YWJhc2UiLCJfX2Rpcm5hbWUiLCJtb2NrcyIsInZhbGlkQ2FyIiwidmFsaWRDYXJDYXRlZ29yeSIsInZhbGlkQ3VzdG9tZXIiLCJjYXJTZXJ2aWNlIiwic2FuZGJveCIsImNhcnMiLCJjcmVhdGVTYW5kYm94IiwicmVzdG9yZSIsImNhciIsImNhckNhdGVnb3J5IiwiT2JqZWN0IiwiY3JlYXRlIiwiY2FySWRzIiwiaWQiLCJzdHViIiwiY2FyUmVwb3NpdG9yeSIsInJldHVybnMiLCJzcHkiLCJyZXN1bHQiLCJnZXRBdmFpbGFibGVDYXIiLCJleHBlY3RlZCIsImNob29zZVJhbmRvbUNhciIsImNhbGxlZE9uY2UiLCJ0byIsImJlIiwib2siLCJmaW5kIiwiY2FsbGVkV2l0aEV4YWN0bHkiLCJkZWVwIiwiZXF1YWwiLCJpbmRleGVzIiwiZ2V0UmFuZG9tUG9zaXRpb25Gcm9tQXJyYXkiLCJsdGUiLCJsZW5ndGgiLCJhbmQiLCJndGUiLCJjdXN0b21lciIsImFnZSIsInByaWNlIiwibnVtYmVyT2ZEYXlzIiwiZ2V0IiwiZnJvbSIsInRheCIsImN1cnJlbmN5Rm9ybWF0IiwiZm9ybWF0IiwiY2FsY3VsYXRlRmluYWxQcmljZSIsImR1ZURhdGUiLCJub3ciLCJEYXRlIiwidXNlRmFrZVRpbWVycyIsImdldFRpbWUiLCJyZXNvbHZlcyIsImV4cGVjdGVkQW1vdW50IiwicmVudCIsImFtb3VudCJdLCJzb3VyY2VzIjpbImNhci5zZXJ2aWNlLnRlc3QuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgeyBkZXNjcmliZSwgaXQsIGJlZm9yZSwgYmVmb3JlRWFjaCwgYWZ0ZXJFYWNoIH0gPSByZXF1aXJlKCdtb2NoYScpO1xuY29uc3QgQ2FyU2VydmljZSA9IHJlcXVpcmUoJy4uLy4uL3NyYy9zZXJ2aWNlL2Nhci5zZXJ2aWNlJyk7XG5jb25zdCBUcmFuc2FjdGlvbiA9IHJlcXVpcmUoJy4uLy4uL3NyYy9lbnRpdGllcy90cmFuc2FjdGlvbi5lbnRpdHknKTtcblxuY29uc3QgeyBqb2luIH0gPSByZXF1aXJlKCdwYXRoJyk7XG5jb25zdCB7IGV4cGVjdCB9ID0gcmVxdWlyZSgnY2hhaScpO1xuY29uc3Qgc2lub24gPSByZXF1aXJlKCdzaW5vbicpO1xuXG5jb25zdCBjYXJzRGF0YWJhc2UgPSBqb2luKF9fZGlybmFtZSwgJy4vLi4vLi4vZGF0YWJhc2UnLCAnY2Fycy5qc29uJyk7XG5cbmNvbnN0IG1vY2tzID0ge1xuICAgIHZhbGlkQ2FyOiByZXF1aXJlKCcuLi9tb2Nrcy92YWxpZC1jYXIuanNvbicpLFxuICAgIHZhbGlkQ2FyQ2F0ZWdvcnk6IHJlcXVpcmUoJy4uL21vY2tzL3ZhbGlkLWNhci1jYXRlZ29yeS5qc29uJyksXG4gICAgdmFsaWRDdXN0b21lcjogcmVxdWlyZSgnLi4vbW9ja3MvdmFsaWQtY3VzdG9tZXIuanNvbicpLFxufTtcblxuZGVzY3JpYmUoJ0NhclNlcnZpY2UgU3VpdGUgVGVzdHMnLCAoKSA9PiB7XG4gICAgbGV0IGNhclNlcnZpY2UgPSB7fTtcbiAgICBsZXQgc2FuZGJveCA9IHt9O1xuXG4gICAgYmVmb3JlKCgpID0+IHtcbiAgICAgICAgY2FyU2VydmljZSA9IG5ldyBDYXJTZXJ2aWNlKHsgY2FyczogY2Fyc0RhdGFiYXNlIH0pO1xuICAgIH0pO1xuXG4gICAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgICAgIHNhbmRib3ggPSBzaW5vbi5jcmVhdGVTYW5kYm94KCk7XG4gICAgfSk7XG5cbiAgICBhZnRlckVhY2goKCkgPT4ge1xuICAgICAgICBzYW5kYm94LnJlc3RvcmUoKTtcbiAgICB9KTtcblxuICAgIGl0KCdnaXZlbiBhIGNhdGVnb3J5IGl0IHNob3VsZCByZXR1cm4gYSBhdmFpbGFibGUgY2FyJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zdCBjYXIgPSBtb2Nrcy52YWxpZENhcjtcbiAgICAgICAgY29uc3QgY2FyQ2F0ZWdvcnkgPSBPYmplY3QuY3JlYXRlKG1vY2tzLnZhbGlkQ2FyQ2F0ZWdvcnkpO1xuXG4gICAgICAgIGNhckNhdGVnb3J5LmNhcklkcyA9IFtjYXIuaWRdO1xuXG4gICAgICAgIHNhbmRib3guc3R1YihcbiAgICAgICAgICAgIGNhclNlcnZpY2UuY2FyUmVwb3NpdG9yeSxcbiAgICAgICAgICAgICdmaW5kJ1xuICAgICAgICApLnJldHVybnMobW9ja3MudmFsaWRDYXIpO1xuXG4gICAgICAgIHNhbmRib3guc3B5KFxuICAgICAgICAgICAgY2FyU2VydmljZSxcbiAgICAgICAgICAgICdjaG9vc2VSYW5kb21DYXInXG4gICAgICAgICk7XG5cbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY2FyU2VydmljZS5nZXRBdmFpbGFibGVDYXIoY2FyQ2F0ZWdvcnkpO1xuICAgICAgICBjb25zdCBleHBlY3RlZCA9IGNhcjtcblxuICAgICAgICBleHBlY3QoY2FyU2VydmljZS5jaG9vc2VSYW5kb21DYXIuY2FsbGVkT25jZSkudG8uYmUub2s7XG4gICAgICAgIGV4cGVjdChjYXJTZXJ2aWNlLmNhclJlcG9zaXRvcnkuZmluZC5jYWxsZWRXaXRoRXhhY3RseShjYXIuaWQpKS50by5iZS5vaztcbiAgICAgICAgZXhwZWN0KHJlc3VsdCkudG8uYmUuZGVlcC5lcXVhbChleHBlY3RlZCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJldHJpdmUgYSByYW5kb20gcG9zaXRpb24gZnJvbSBhbiBhcnJheScsICgpID0+IHtcbiAgICAgICAgY29uc3QgaW5kZXhlcyA9IFswLDEsMiwzLDRdO1xuICAgICAgICBjb25zdCByZXN1bHQgPSBjYXJTZXJ2aWNlLmdldFJhbmRvbVBvc2l0aW9uRnJvbUFycmF5KGluZGV4ZXMpO1xuXG4gICAgICAgIGV4cGVjdChyZXN1bHQpLnRvLmJlLmx0ZShpbmRleGVzLmxlbmd0aCkuYW5kLmJlLmd0ZSgwKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgY2hvb3NlIHRoZSBmaXJzdCBJRCBmcm9tIGNhcnNJZHMgaW4gY2FyQ2F0ZWdvcnknLCAoKSA9PiB7XG4gICAgICAgIGNvbnN0IGNhckNhdGVnb3J5ID0gbW9ja3MudmFsaWRDYXJDYXRlZ29yeTtcblxuICAgICAgICBzYW5kYm94LnN0dWIoY2FyU2VydmljZSwgJ2dldFJhbmRvbVBvc2l0aW9uRnJvbUFycmF5JykucmV0dXJucygwKTtcblxuICAgICAgICBjb25zdCByZXN1bHQgPSBjYXJTZXJ2aWNlLmNob29zZVJhbmRvbUNhcihjYXJDYXRlZ29yeSk7XG5cbiAgICAgICAgY29uc3QgZXhwZWN0ZWQgPSBjYXJDYXRlZ29yeS5jYXJJZHNbMF07XG5cbiAgICAgICAgZXhwZWN0KGNhclNlcnZpY2UuZ2V0UmFuZG9tUG9zaXRpb25Gcm9tQXJyYXkuY2FsbGVkT25jZSkudG8uYmUub2s7XG4gICAgICAgIGV4cGVjdChyZXN1bHQpLnRvLmJlLmVxdWFsKGV4cGVjdGVkKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgY2FsY3VsYXRlIGZpbmFsIGFtb3VudCBpbiByZWFsIHdoZW4gYSBjYXJDYXRlZ29yeSwgY3VzdG9tZXIgYW5kIG51bWJlck9mRGF5IHdlcmUgZ2l2ZW4nLCAoKSA9PiB7XG4gICAgICAgIGNvbnN0IGN1c3RvbWVyID0gT2JqZWN0LmNyZWF0ZShtb2Nrcy52YWxpZEN1c3RvbWVyKTtcbiAgICAgICAgY3VzdG9tZXIuYWdlID0gNTA7XG5cbiAgICAgICAgY29uc3QgY2FyQ2F0ZWdvcnkgPSBPYmplY3QuY3JlYXRlKG1vY2tzLnZhbGlkQ2FyQ2F0ZWdvcnkpO1xuICAgICAgICBjYXJDYXRlZ29yeS5wcmljZSA9IDM3LjY7XG5cbiAgICAgICAgY29uc3QgbnVtYmVyT2ZEYXlzID0gNTtcblxuICAgICAgICBzYW5kYm94LnN0dWIoXG4gICAgICAgICAgICBjYXJTZXJ2aWNlLFxuICAgICAgICAgICAgJ3RheEJhc2VkT25BZ2UnXG4gICAgICAgICkuZ2V0KCgpID0+IFt7IGZyb206IDQwLCB0bzogNTAsIHRheDogMS4zIH1dKTtcblxuICAgICAgICBjb25zdCBleHBlY3RlZCA9IGNhclNlcnZpY2UuY3VycmVuY3lGb3JtYXQuZm9ybWF0KDI0NC40MCk7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGNhclNlcnZpY2UuY2FsY3VsYXRlRmluYWxQcmljZShjdXN0b21lciwgY2FyQ2F0ZWdvcnksIG51bWJlck9mRGF5cyk7XG5cbiAgICAgICAgZXhwZWN0KHJlc3VsdCkudG8uYmUuZGVlcC5lcXVhbChleHBlY3RlZCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJldHVybiBhIHRyYW5zYWN0aW9uIHJlY2VpcHQgd2hlbiBhIGN1c3RvbWVyIGFuZCBhIGNhciBjYXRlZ29yeSB3ZXJlIGdpdmVuJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zdCBjYXIgPSBPYmplY3QuY3JlYXRlKG1vY2tzLnZhbGlkQ2FyKTtcbiAgICAgICAgY29uc3QgY2FyQ2F0ZWdvcnkgPSB7XG4gICAgICAgICAgICAuLi5tb2Nrcy52YWxpZENhckNhdGVnb3J5LFxuICAgICAgICAgICAgcHJpY2U6IDM3LjYsXG4gICAgICAgICAgICBjYXJJZHM6IFtjYXIuaWRdXG4gICAgICAgIH07XG5cbiAgICAgICAgY29uc3QgY3VzdG9tZXIgPSBPYmplY3QuY3JlYXRlKG1vY2tzLnZhbGlkQ3VzdG9tZXIpO1xuICAgICAgICBjdXN0b21lci5hZ2UgPSAyMDtcblxuICAgICAgICBjb25zdCBudW1iZXJPZkRheXMgPSA1O1xuICAgICAgICBjb25zdCBkdWVEYXRlID0gJzEwIGRlIG5vdmVtYnJvIGRlIDIwMjAnO1xuXG4gICAgICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKDIwMjAsIDEwLCA1KTtcbiAgICAgICAgXG4gICAgICAgIHNhbmRib3gudXNlRmFrZVRpbWVycyhub3cuZ2V0VGltZSgpKTtcbiAgICAgICAgc2FuZGJveC5zdHViKGNhclNlcnZpY2UsICdnZXRBdmFpbGFibGVDYXInKS5yZXNvbHZlcyhjYXIpO1xuXG4gICAgICAgIGNvbnN0IGV4cGVjdGVkQW1vdW50ID0gY2FyU2VydmljZS5jdXJyZW5jeUZvcm1hdC5mb3JtYXQoMjA2LjgwKTtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY2FyU2VydmljZS5yZW50KGN1c3RvbWVyLCBjYXJDYXRlZ29yeSwgbnVtYmVyT2ZEYXlzKTtcblxuICAgICAgICBjb25zdCBleHBlY3RlZCA9IG5ldyBUcmFuc2FjdGlvbih7IGN1c3RvbWVyLCBjYXIsIGFtb3VudDogZXhwZWN0ZWRBbW91bnQsIGR1ZURhdGUgfSk7XG5cbiAgICAgICAgZXhwZWN0KHJlc3VsdCkudG8uYmUuZGVlcC5lcXVhbChleHBlY3RlZCk7XG4gICAgfSk7XG59KTsiXSwibWFwcGluZ3MiOiJrbk1BZVk7QUFBQSx5RkFmWixLQUFNLENBQUVBLFFBQVEsQ0FBRUMsRUFBRSxDQUFFQyxNQUFNLENBQUVDLFVBQVUsQ0FBRUMsU0FBVSxDQUFDLHlCQUFHQyxPQUFPLENBQUMsT0FBTyxDQUFDLEVBQ3hFLEtBQU1DLFdBQVUseUJBQUdELE9BQU8sQ0FBQywrQkFBK0IsQ0FBQyxFQUMzRCxLQUFNRSxZQUFXLHlCQUFHRixPQUFPLENBQUMsdUNBQXVDLENBQUMsRUFFcEUsS0FBTSxDQUFFRyxJQUFLLENBQUMseUJBQUdILE9BQU8sQ0FBQyxNQUFNLENBQUMsRUFDaEMsS0FBTSxDQUFFSSxNQUFPLENBQUMseUJBQUdKLE9BQU8sQ0FBQyxNQUFNLENBQUMsRUFDbEMsS0FBTUssTUFBSyx5QkFBR0wsT0FBTyxDQUFDLE9BQU8sQ0FBQyxFQUU5QixLQUFNTSxhQUFZLHlCQUFHSCxJQUFJLENBQUNJLFNBQVMsQ0FBRSxrQkFBa0IsQ0FBRSxXQUFXLENBQUMsRUFFckUsS0FBTUMsTUFBSyx5QkFBRyxDQUNWQyxRQUFRLENBQUVULE9BQU8sQ0FBQyx5QkFBeUIsQ0FBQyxDQUM1Q1UsZ0JBQWdCLENBQUVWLE9BQU8sQ0FBQyxrQ0FB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